<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Nas on Linsama&#39;s Blog</title>
    <link>http://localhost:62448/tags/nas/</link>
    <description>Recent content in Nas on Linsama&#39;s Blog</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 09 Dec 2023 23:16:35 +0800</lastBuildDate>
    <atom:link href="http://localhost:62448/tags/nas/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>NAS 影音下载系统配置</title>
      <link>http://localhost:62448/posts/nas/nas-auto-download-media/</link>
      <pubDate>Sat, 09 Dec 2023 23:16:35 +0800</pubDate>
      <guid>http://localhost:62448/posts/nas/nas-auto-download-media/</guid>
      <description>&lt;h2 id=&#34;背景&#34;&gt;背景&lt;/h2&gt;&#xA;&lt;p&gt;为了保证各个年龄段祖国花朵的健康成长，我们在国内的流媒体平台上看到的影视资源都是经过美化的，都有着不亚于新闻联播的祥和画面。然，纵使风景这边独好，有的时候我们依然要带着批判的眼光，去看、去听、去感受外面世界的险恶与残酷，以便解救西方世界的人名群众于水火，实现人类大同的理想&amp;hellip;&amp;hellip;&lt;/p&gt;&#xA;&lt;p&gt;额咳咳，扯远了。总之，大部分人搭建 NAS 的初衷，可能都是更方便的管理影视剧资源。对于喜欢看动漫的人，可能还希望可以每周同步下载最新的番剧，因此，在这里介绍一套基于 Sonarr 等软件的影音资源管理系统，主要实现了以下功能：&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;自动下载最新的番剧、电影、电视剧等资源&lt;/li&gt;&#xA;&lt;li&gt;影视资源的分类管理&lt;/li&gt;&#xA;&lt;li&gt;搜刮资源信息&lt;/li&gt;&#xA;&lt;li&gt;多端播放&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 id=&#34;整体架构&#34;&gt;整体架构&lt;/h2&gt;&#xA;&lt;h3 id=&#34;平台信息&#34;&gt;平台信息&lt;/h3&gt;&#xA;&lt;p&gt;本人使用的是 Unraid 系统，因此接下来都以 Unraid 为例。所有的服务都是使用 Docker 容器的方式运行，对于支持 Docker 的系统，都可以参考本文的配置进行相应的修改。&lt;/p&gt;&#xA;&lt;h3 id=&#34;系统组成&#34;&gt;系统组成&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sonarr：番剧下载管理，支持动漫、电视剧的搜索和下载&lt;/li&gt;&#xA;&lt;li&gt;Radarr：电影下载管理，支持电影的搜索和下载&lt;/li&gt;&#xA;&lt;li&gt;Overseerr：媒体请求管理，更现代化的 Web 界面&lt;/li&gt;&#xA;&lt;li&gt;Jackett：资源搜刮，提供各种资源站点的搜索接口，Sonarr、Radarr 通过它来搜索资源&lt;/li&gt;&#xA;&lt;li&gt;（可选）FlareSolverr：解决 Cloudflare 验证问题，提高 Jackett 的资源搜刮成功率&lt;/li&gt;&#xA;&lt;li&gt;qBittorrent：下载器&lt;/li&gt;&#xA;&lt;li&gt;Plex：媒体服务器&lt;/li&gt;&#xA;&lt;li&gt;（可选）JProxy：Sonarr、Radarr 与 Jackett 之间的代理，优化资源匹配结果&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 id=&#34;安装配置&#34;&gt;安装配置&lt;/h2&gt;&#xA;&lt;h3 id=&#34;安装-docker&#34;&gt;安装 Docker&lt;/h3&gt;&#xA;&lt;p&gt;Unraid 系统默认已经安装了 Docker。如果是其他系统或平台，可参考各自的官方文档进行安装，或者参考 &lt;a href=&#34;https://docs.docker.com/engine/install/&#34;&gt;Docker 官方文档&lt;/a&gt; 进行手动安装。&lt;/p&gt;&#xA;&lt;h3 id=&#34;目录准备&#34;&gt;目录准备&lt;/h3&gt;&#xA;&lt;p&gt;为了实现各个服务之间的交互和数据共享，需要提前对可能使用的目录进行规划。以 Unraid 为例，使用到的目录如下：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;/mnt/user/appdata：Docker 容器的配置文件目录，各服务涉及到服务本身的配置，统一扔在这里&lt;/li&gt;&#xA;&lt;li&gt;/mnt/user/media/movies：电影媒体库目录&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Radarr 使用此目录作为&lt;strong&gt;电影&lt;/strong&gt;媒体库目录&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;/mnt/user/media/tv：电视剧媒体库目录&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sonarr 使用此目录作为&lt;strong&gt;影视剧&lt;/strong&gt;媒体库目录&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;/mnt/user/media/anime：动漫媒体库目录&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sonarr 使用此目录作为&lt;strong&gt;动漫&lt;/strong&gt;媒体库目录&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;/mnt/user/media/downloads：下载目录&#xA;&lt;ul&gt;&#xA;&lt;li&gt;qBittorrent 使用此目录作为下载目录&lt;/li&gt;&#xA;&lt;li&gt;Sonarr、Radarr 从此目录读取数据，并移动到相应的媒体库目录&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;如果创建 Docker 服务时以上目录没有自动创建，可以提前手工创建。&lt;/p&gt;</description>
    </item>
    <item>
      <title>家庭网络改造 1： 路由器系统</title>
      <link>http://localhost:62448/posts/nas/home-server/</link>
      <pubDate>Mon, 20 Nov 2023 21:19:58 +0800</pubDate>
      <guid>http://localhost:62448/posts/nas/home-server/</guid>
      <description>&lt;h2 id=&#34;0-引言&#34;&gt;0. 引言&lt;/h2&gt;&#xA;&lt;p&gt;在日常的工作和生活之中，总有一些网络上的需求和问题需要解决。比如：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;如何访问 GitHub？&lt;/li&gt;&#xA;&lt;li&gt;如何在联机游戏中获得稳定的环境？&lt;/li&gt;&#xA;&lt;li&gt;不在家中如何访问 Nas 中的资源？&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;解决这些问题的一个简单途径，既是在家中搭建一个功能丰富的软路由系统，实现各种高级的网络功能，同时也是后续置办 Nas，搭建私有云的基础。&lt;/p&gt;&#xA;&lt;h2 id=&#34;1-网络环境概述&#34;&gt;1. 网络环境概述&lt;/h2&gt;&#xA;&lt;h3 id=&#34;11-总体架构&#34;&gt;1.1. 总体架构&lt;/h3&gt;&#xA;&lt;p&gt;&lt;img src=&#34;architecture.png&#34; alt=&#34;home-network-architecture&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;12-设备清单&#34;&gt;1.2. 设备清单&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;光猫：使用运营商提供的光猫，包含了 WiFi 的功能，保障软路由即使挂掉，依然有网络可以访问&lt;/li&gt;&#xA;&lt;li&gt;软路由：一台 x86 或者 arm 的机器，文中使用的是 N5105&lt;/li&gt;&#xA;&lt;li&gt;AP 节点：用于扩展网络信号&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 id=&#34;13-方案选择&#34;&gt;1.3. 方案选择&lt;/h3&gt;&#xA;&lt;p&gt;将 OpenWrt 直接安装在软路由上，无疑可以获得最好的性能，但是此方案也存在一些弊端。如果在折腾 OpenWrt 系统的过程中出现某些异常，OpenWrt 无法访问，将影响全局的网络访问&lt;/p&gt;&#xA;&lt;p&gt;为了可以随时折腾家中的网络，同时保证家人的网络访问不受影响，我们选择在 PVE 上安装 OpenWrt 系统&lt;/p&gt;&#xA;&lt;h2 id=&#34;2-pve-的安装与配置&#34;&gt;2. PVE 的安装与配置&lt;/h2&gt;&#xA;&lt;h3 id=&#34;21-pve-系统安装&#34;&gt;2.1. PVE 系统安装&lt;/h3&gt;&#xA;&lt;p&gt;PVE 的安装可以参考 &lt;a href=&#34;https://pve.proxmox.com/wiki/Installation&#34;&gt;PVE 官方文档&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;22-pve-开启硬件直通&#34;&gt;2.2. PVE 开启硬件直通&lt;/h3&gt;&#xA;&lt;p&gt;为了获得更好的性能，可以在安装完成 PVE 后，开启硬件直通功能，将网卡直通给 OpenWrt 使用&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;1. 启用 IOMMU&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;在主机 BIOS 设置中启用 &lt;code&gt;VT-d&lt;/code&gt;（对于Intel处理器）或 &lt;code&gt;AMD-Vi&lt;/code&gt;（对于AMD处理器）功能。&lt;/p&gt;&#xA;&lt;p&gt;修改GRUB配置文件（通常是 &lt;code&gt;/etc/default/grub&lt;/code&gt;），添加或修改以下条目：&lt;/p&gt;&#xA;&lt;p&gt;Intel 处理器添加以下内容：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
